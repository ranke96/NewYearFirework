<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>2024新年倒數</title>
    <style>
            .fireworks-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  z-index: 9999; /* 確保煙火容器在最上層 */
    }
    
    #countdown {
      color: #fff; /* 白色文字 */
      font-family: 'Noto Sans TC', sans-serif; /* 使用指定字体 */
      font-weight: 900; /* 设置字体粗细 */
      font-size: 24px;
      text-align: center;
      position: absolute; /* 絕對定位 */
      top: 50%; /* 垂直置中 */
      left: 50%; /* 水平置中 */
      transform: translate(-50%, -50%); /* 水平和垂直置中 */
      z-index: 9999; /* 最上層 */
    }
    .new-year-message {
      font-family: 'Noto Sans TC', sans-serif; /* 使用指定字体 */
      font-weight: 900; /* 设置字体粗细 */
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 48px;
      text-align: center;
      opacity: 0;
      transition: opacity 2s, font-size 2s;
      z-index: 9999;
      color: #fff; /* 白色文字 */
    }
    .test-button {
      position: absolute;
      top: calc(50% - 60px); /* 位于 .lua .textura 上方 */
      left: calc(50% - 60px); /* 居中 */
      width: 120px;
      height: 120px;
      background-color: transparent; /* 设为透明 */
      color: #fff;
      border: none;
      font-size: 24px;
      cursor: pointer;
      border-radius: 50%; /* 圆形按钮 */
      z-index: 10000; /* 确保在最上层 */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* 鼠标悬停时的样式 */
  </style>
  <link rel="stylesheet" href="css/StarrySky.css">
  <link rel="stylesheet" href="css/snow.css">
   <script src="https://cdn.jsdelivr.net/npm/fireworks-js@2.x/dist/index.umd.js"></script>
   <script src="js/StarrySky.js"></script>
   <script src="js/switch.js"></script>
   <script src="js/snow.js"></script>

</head>
<body>
<div id="countdown"></div>
<div class="fireworks-container"></div>  

<div class="noite"><canvas id="rainCanvas"></canvas></div>
    
<div class="constelacao"></div>
<div class="lua">
  <div class="textura"></div>

    <button class="test-button" onclick="startCountdown(); playAudio();"></button>
</div>
<div class="snow-container" style="display: none;"></div>
    
<div class="chuvaMeteoro"></div>
      <div class="floresta">
    <img src="image/city.png" alt="" />
  </div>
  <script src="js/rain.js"></script>
<script>
  // 设置跨年的时间点
  const newYearTime = new Date('January 1, 2024 00:00:00').getTime();
    //'January 1, 2024 00:00:00'
//'December 31, 2023 23:59:59'
  // 更新倒计时和特殊效果
  const updateCountdown = () => {
    const now = new Date().getTime();
    const distance = newYearTime - now;

    if (distance < 0) {
      clearInterval(interval);
      countdown.style.display = 'none';
      startFireworks();
      displayHappyNewYearMessage();
      return;
    }

    let days = Math.floor(distance / (1000 * 60 * 60 * 24));
    let hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    let minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    let seconds = Math.floor((distance % (1000 * 60)) / 1000);

    let countdownText = '';
    
    if (days > 0) {
      countdownText += `${days} 天 `;
    }
    if (hours > 0 || days > 0) {
      countdownText += `${hours} 小時 `;
    }
    if (minutes > 0 || hours > 0 || days > 0) {
      countdownText += `${minutes} 分鐘 `;
    }
    countdownText += `${seconds} 秒`;

    countdown.innerHTML = `${countdownText}`;
      
    if (distance <= 11000) {
      countdown.style.fontSize = '100px';
    } else {
      countdown.style.fontSize = '48px';
    }
  };

  function displayHappyNewYearMessage() {
    const happyNewYearMessage = document.createElement('div');
    happyNewYearMessage.textContent = '2024新年快樂';
    happyNewYearMessage.className = 'new-year-message';
    document.body.appendChild(happyNewYearMessage);

    setTimeout(() => {
      happyNewYearMessage.style.opacity = '1';
      happyNewYearMessage.style.fontSize = '72px';
    }, 10);

    setTimeout(() => {
      happyNewYearMessage.style.opacity = '0';
    }, 2000);

    setTimeout(() => {
      happyNewYearMessage.style.display = 'none';
    }, 3000);
  }

  const interval = setInterval(updateCountdown, 1000);

  // 在特定時間啟動煙火效果
  function startFireworks() {
  const container = document.querySelector('.fireworks-container');
  const fireworksConfig = {
    autoresize: true,
    opacity: 0.5,
    acceleration: 1.05,
    friction: 0.97,
    gravity: 1.5,
    particles: 50,
    traceLength: 3,
    traceSpeed: 10,
    explosion: 5,
    intensity: 30,
    flickering: 50,
    lineStyle: 'round',
    hue: {
      min: 0,
      max: 360
    },
    delay: {
      min: 30,
      max: 60
    },
    rocketsPoint: {
      min: 50,
      max: 50
    },
    lineWidth: {
      explosion: {
        min: 1,
        max: 3
      },
      trace: {
        min: 1,
        max: 2
      }
    },
    brightness: {
      min: 50,
      max: 80
    },
    decay: {
      min: 0.015,
      max: 0.03
    },
    mouse: {
      click: true,
      move: false,
      max: 10
    },
      sound: {
        enabled: true,
      files: ["https://fireworks.js.org/sounds/explosion0.mp3", "https://fireworks.js.org/sounds/explosion1.mp3",  "https://fireworks.js.org/sounds/explosion2.mp3"],
      volume: {
        min: 4,
        max: 8
      }
    }
      
  };

  const fireworks = new Fireworks.default(container, fireworksConfig);
    fireworks.start();
  }
  function startCountdown() {
    displayHappyNewYearMessage(); // 首先显示新年祝福信息
    startFireworks(); // 然后开始烟火效果
    clearInterval(interval); // 清除现有的倒计时
    updateCountdown(); // 立即更新倒计时
    document.getElementById('countdown').style.display = 'none';
  }
</script>

</body>
</html>
